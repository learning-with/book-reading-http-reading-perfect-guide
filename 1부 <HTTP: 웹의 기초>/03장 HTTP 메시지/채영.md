# 03 HTTP 메시지

HTTP 애플리케이션 간에 주고받은 데이터의 블록들(메시지의 내용과 의미를 설명하는 텍스트 메타 정보로 시작)

## 3.1 메시지의 흐름

- 메시지는 클라이언트, 서버, 프락시 사이에 흐름.
- 메시지의 방향은 인바운드, 아웃바운드, 업스트림, 다운스트림 용어 사용

### 3.1.1 메시지는 원 서버 방향을 인바운드로 하여 송신된다

인바운드, 아웃바운드는 트랜잭션 방향을 표현하기 위해 사용.

- 인바운드로 이동 : 메시지가 원 서버로 향하는 것`req`
- 아웃바운드로 이동 : 모든 처리가 끝난 뒤에 메시지가 사용자 에이전트로 돌아오는 것`res`

### 3.1.2 다운스트림으로 흐르는 메시지

메시지는 다운스트림으로 흐르지만 메시지의 발송자는 수신자의 업스트림.(HTTP 메시지는 강물 같이 흐른다 생각하기)

## 3.2 메시지의 각 부분

시작줄, 헤더 블록, 본문 세 부분으로 나뉨. 시작줄과 헤더는 아스키 문자열. 줄 바꿈 문자열은 `CRLF`이라고 씀.

- 시작줄 : 메시지의 종류
- 헤더 블록 : 속성
- 본문 : 데이터

### 3.2.1 메시지 문법

모든 HTTP 메시지는 요청 메시지나 응답 메시지로 분류됨. 요청 메시지는 명령과 URL을 포함, 응답 메시지는 트랙잭션의 결과를 포함함.

#### 요청 메시지 형식

> <메서드> <요청 URL> <버전>
> <헤더>
>
> <엔터티 본문>

#### 응답 메시지 형식

> <버전> <상태코드> <사유 구절>
> <헤더>
>
> <엔터티 본문>

| 구성요소                 | 설명                                                                                                                   |
| ------------------------ | ---------------------------------------------------------------------------------------------------------------------- |
| 메서드                   | 클라이언트 픅에서 서버가 리소스에 대해 수행해주길 바라는 동작. `GET`, `HEAD`, `POST` 등 한 단어로 되어 있음.           |
| 요청 URL                 | 요청 대상이 되는 리소스를 지칭하는 완전한 URL 혹은 URL의 경로 구성요소.                                                |
| 버전                     | 메시지에서 사용 중인 HTTP의 버전. `HTTP/<메이저>.<마이너>` 여기서 메이저, 마이너는 모두 정수임.                        |
| 상태코드                 | 요청 중에 무엇이 일어났는지 설명하는 세 자리 수. 첫 번째 자릿수는 상태의 일반적인 분류를 나타냄.                       |
| 사유 구절(reason-phrase) | 숫자로 된 상태 코드의 의미를 사람이 이해할 수 있게 설명해주는 짧은 문구. 상태코드 이후부터 줄바꿈 문자열까지 사유 구절 |
| 헤더들                   | 이름, 콜론`:`, 선택적인 공백, 값, CRLF가 순서대로 나타나는 0개 이상의 헤더들,                                          |
| 엔터티 본문              | 임의의 데이터 블록을 포함. 모든 메시지가 엔터티 본문을 갖는 것은 아님.                                                 |

### 3.2.2 시작줄

요청줄, 응답줄, 메서드, 상태코드, 사유 구절, 버전 번호

### 3.2.3 헤더

시작줄 다음에 오는 헤더. 요정과 응답 메시지에 추가 정보를 더함.

- 헤더 분류: 일반 헤더, 요청 헤더, Entity헤더, 확장 헤더.
  > 헤더를 여러 줄로 나누기: 추가 줄 앞에는 최소 하나의 스페이스 혹은 탭 문자가 와야함.

### 3.2.4 엔터티 본문

HTTP 메시지의 세 번째 부분은 선택적인 엔터티 본문. 여러 종류의 디지털 데이터를 실어 나를 수 있음.

### 3.2.5 버전 0.9 메시지

HTTP 프로토콜의 초기 버전임. 메서드와 요청 URL/ 응답은 엔터티로만 구성되어있어, 현재의 HTTP 기능들과 애플리케이션들 대부분 구현 불가.

## 3.3 메서드

### 3.3.1 안전한 메서드( Safe Method )

`GET`, `HEAD` 메서드와 같이 HTTP 요청의 결과로 서버에 어떤 작용도 없는 메서드.

### 3.3.2 GET

서버에 리소스 요청.

### 3.3.3 HEAD

GET 처럼 해동하지만, 서버는 응답을 엔터티 본문에 반환하는 일 없이, 헤더로만 돌려줌.

- 개체 존재 유무 확인.
- 리소스를 가져오지 않고도 무엇인가(타입 등)를 알아낼 수 있음.
- 헤더를 확인하여 리소스가 변경되었는지 검사할 수 있음.

### 3.3.4 PUT

서버에 문서를 쓸 수 있는 메서드.

### 3.3.5 POST

서버에 입력 데이터를 전송.

### 3.3.6 TRACE

클라이언트가 어떤 요청을 할 때, 그 요청은 방화벽, 프락시, 게이트웨이 등의 애플리케이션을 통과 할 수 있음. 이때 클라이언트에게 자신의 요청이 서버에 도달했을 때 어떻게 보이게 되는지 알려줌. 주로 진단을 위해 사용함.

### 3.3.7 OPTIONS

웹 서버에게 여러 가진 종류의 지원 범위에 대해 물어봄.

### 3.3.8 DELETE

요청 URL로 지정한 리소스 삭제 요청.

### 3.3.9 확장 메서드

필요에 따라 확장해도 기존 메서드에는 문제가 생기지 않음.

- 예시 확장 메서드 : `LOCK`,`MKCOL`,`COPY`,`MOVE`등등

## 3.4 상태 코드

### 3.4.1 100-199 : 정보성 상태 코드

- `100` 요청의 시작 부분 일부가 받아들여짐. 나머지는 클라이언트에서 이어서 보내야함.
- `101` Switching Protocols 클라이언트가 Upgrade 헤더에 나열한 것 중 하나로 서버가 프로토콜을 바꾸었음을 의미.

### 3.4.2 200-299 : 성공 상태 코드

- `200` 요청 정상. 엔터티 본문은 요청된 리소스를 포함하고 있음.
- `201` Created 서버 개체를 생성하라는 요청을 위한 것.
- `202` 요청은 받아들여졌으나 서버에서 동작을 수행하지 않음.
- `206` 부분적 요청에 성공함. 범위 요청

### 3.4.3 300-399 : 리다이렉션 상태 코드

- `301` 요청한 URL이 옮겨졌을 때 사용.

### 3.4.4 400-499 : 클라이언트 에러 상태 코드

- `400` Bad Request
- `404` Not Found
- `405` Method Not Allowed
- `408` Request Time out

### 3.4.5 500-599 : 서버 에러 상태 코드

- `500` Internal Server Error
- `504` Gateway Time out

## 3.5 헤더

일반 헤더, 요청 헤더, 응답 헤더, 엔터티 헤더, 확장 헤더

### 3.5.1 일반 헤더

아주 기본적인 정보 제공.

### 3.5.2 요청 헤더

요청 메시지에서만 의미를 갖는 헤더.

### 3.5.3 응답 헤더

부가 정보 제공, 응답자 능력이 어떻게 되는지, 응답에 대한 설명 등등 제공.

### 3.5.4 엔터디 헤더

개체의 타입 부터 주어진 리소스에 대해 요청할 수 있는 유효한 메서드, 광범위한 정보를 제공함.

## 3.6 추가 정보
