# 6. 프락시
## 6.1 웹 중개자
클라이언트의 입장에서 트랜잭션을 수행하는 중개인

HTTP 클라이언트의 요청을 받게 되므로, 반드시 웹 서버처럼 요청과 커넥션을 적절히 다루고 응답을 돌려줘야함

동시에 요청을 서버로 보내기도 하므로, 요청을 보내고 응답을 받는 올바른 HTTP 클라이언트처럼 동작해야함
### 6.1.1 개인 프락시와 공유 프락시
#### 공용 프락시
공용이며 공유된 프락시

중앙 집중형 프락시를 관리하는 게 더 비용효율이 높고 쉬움(캐시 프락시 등 공통된 요청에서 유리)
#### 개인 프락시
개별 사용자 또는 조직이 소유하고 제어
### 6.1.2 프락시 대 게이트웨이
같은 프로토콜을 사용하는 둘 이상의 애플리케이션을 연결하고, 게이트웨이는 서로 다른 프로토콜을 사용하는 둘 이상을 연결

게이트웨이는 클라이언트와 서버가 서로 다른 프로토콜로 말하더라도 서로 간의 트랜잭션을 완료할 수 있도록 해주는 프로토콜 변환기처럼 동작

- 클라이언트와 서버 양쪽 모두에게 HTTP로 말하면 HTTP 프락시
- HTTP 프론트엔드에 매여서 POP 이메일 백엔드를 향하면 HTTP/POP 게이트웨이(웹 트랜잭션을 적절한 POP 트랜잭션으로 변환하고 사용자가 이메일을 HTTP를 통해 읽을 수 있게 해줌)

실질적으로 프락시와 게이트웨이의 차이점은 모호

프락시는 때때로 약간의 프로토콜 변환을 하기도 하며, 상용 프락시 서버는 SSL 보안 프로토콜, SOCKS 방화벽, FTP 접근, 그리고 웹 기반 애플리케이션을 지원하기 위해 게이트웨이 기능을 구현

## 6.2 왜 프락시를 사용하는가?
보안을 개선하고, 성능을 높여주며, 비용을 절약

모든 HTTP 트래픽을 들여다보고 건드릴 수 있기 때문에, 부가적인 가치를 주는 여러 유용한 웹 서비스를 구현하기 위해 트래픽을 감시하고 수정가능
#### 어린이 필터
교육사이트를 제공하면서 동시에 성인 콘텐츠를 차단하기 위해 필터링 프락시 사용 가능
#### 문서 접근 제어자
많은 웹 서버들과 웹 리소스에 대한 단일한 접근 제어 전략을 구현하고 감사 추적을 하기 위해 사용 가능

각기 다른 조직에서 관리되는 다양한 종류의 수많은 웹 서버들에 대한 접근 제어를 수시로 갱신할 필요 없이, 중앙 프락시 서버에서 접근 제어를 설정 가능
#### 보안 방화벽
네트워크 보안 엔지니어는 종종 보안을 강화하기 위해 프락시 서버 사용

프락시 서버는 조직 안에 들어오거나 나가는 응용 레벨 프로토콜의 흐름을 네트워크의 한 지점에서 통제

바이러스를 제거하는 웹이나 이메일 프락시가 사용할 수 있는, 트래픽을 세심히 볼 수 있는 후크를 제공
#### 웹 캐시
프락시 캐시는 인기 있는 문서의 로컬 사본을 관리하고 해당 문서에 대한 요청이 오면 빠르게 제공하여, 느리고 비싼 인터넷 커뮤니케이션을 줄임
#### 대리 프락시
진짜 웹 서버 요청을 받지만 웹 서버와는 달리 요청 받은 콘텐츠의 위치를 찾아내기 위해 다른 서버와 커뮤니케이션을 시작

공용 콘텐츠에 대한 느린 웹 서버의 성능을 개선하기 위해 사용 가능

콘텐츠 라우팅 기능과 결합되어 주문형 복제 콘텐츠의 분산 네트워크를 만들기 위해 사용 가능
#### 콘텐츠 라우터
인터넷 트래픽 조건과 콘텐츠의 종류에 따라 요청을 특정 웹 서버로 유도하는 콘텐츠 라우터로 동작 가능

사용자들에게 제공할 여러 서비스를 구현하는데 사용 가능
#### 트랜스코더
콘텐츠를 클라이언트에게 전달하기 전에 본문 포맷을 수정 가능

*트랜스코딩: 데이터의 표현 방식을 자연스럽게 변환하는 것

ex. 크기를 줄이기 위해 자신을 거쳐가는 GIF 이미지를 JPG 이미지로 변환
#### 익명화 프락시
HTTP 메시지에서 신원을 식별할 수 있는 특성들(클라이언트IP주소, From 헤더, Referer 헤더, 쿠키, URI 세션 아이디)을 적극적으로 제거함으로써 개인 정보 보호와 익명성 보장에 기여
## 6.3 프락시는 어디에 있는가?
### 6.3.1 프락시 서버 배치
#### 출구(Egress) 프락시
로컬 네트워크와 더 큰 인터넷 사이를 오가는 트래픽을 제어하기 위해 프락시를 로컬 네트워크의 출구에 넣을 수 있음

해커를 막는 방화벽을 제공하기 위해, 인터넷 요금을 절약하고 인터넷 트래픽의 성능을 개선하기 위해 회사에서 출구 프락시 사용 가능

초등학교에서 부적절한 콘텐츠를 브라우징하는 것을 막기 위해 필터링 출구 프락시를 사용 가능
#### 접근(입구) 프락시
고객으로부터의 모든 요청을 종합적으로 처리하기 위해 프락시는 ISP 접근 지점에 위치하기도 함

*ISP: 사용자들의 다운로드 속도를 개선하고 인터넷 대역폭 비용을 줄이기 위해 캐시 프락시를 사용해 많이 찾는 문서들의 사본을 저장
#### 대리 프락시
네트워크의 가장 끝에 있는 웹 서버들의 바로 앞에 위치하여 웹 서버로 향하는 모든 요청을 처리하고 필요할 때만 웹 서버에게 자원을 요청 가능
#### 네트워크 교환 프락시
캐시를 이용해 인터넷 교차로의 혼잡을 완화하고 트래픽 흐름을 감시하기 위해, 충분한 처리 능력을 갖춘 프락시가 네트워크 사이의 인터넷 피어링 교환 지점들에 놓일 수 있음
### 6.3.2 프락시 계층
프락시는
#### 프락시 계층 콘텐츠 라우팅
### 6.3.3 어떻게 프락시가 트래픽을 처리하는가
#### 클라이언트를 수정한다
#### 네트워크를 수정한다
#### DNS 이름공간을 수정한다
#### 웹 서버를 수정한다
## 6.4 클라이언트 프락시 설정
### 6.4.1 클라이언트 프락시 설정: 수동
### 6.4.2 클라이언트 프락시 설정: PAC 파일
### 6.4.3 클라이언트 프락시 설정: WPAD
## 6.5 프락시 요청의 미묘한 특징들
### 6.5.1 프락시 URI는 서버 URI와 다르다
### 6.5.2 가상 호스팅에서 일어나는 같은 문제
### 6.5.3 인터셉트 프락시는 부분 URI를 받는다
### 6.5.4 프락시는 프락시 요청과 서버 요청을 모두 다룰 수 있다
### 6.5.5 전송 중 URI 변경
### 6.5.6 URI 클라이언트 자동확장과 호스트 명 분석(Hostname Resolution)
### 6.5.7 프락시 없는 URI 분석(URI Resolution)
### 6.5.8 명시적인 프락시를 사용할 때의 URI 분석
### 6.5.9 인터셉트 프락시를 이용한 URI 분석
## 6.6 메시지 추적
### 6.6.1 Via 헤더
#### Via 문법
#### Via 요청과 응답 경로
#### Via와 게이트웨이
#### Server 헤더와 Via 헤더
#### Via가 개인정보 보호와 보안에 미치는 영향
### 6.6.2 TRACE 메서드
## 6.7 프락시 인증
## 6.8 프락시 상호운용성
### 6.8.1 지원하지 않는 헤더와 메서드 다루기
### 6.8.2 OPTIONS: 어떤 기능을 지원하는지 알아보기
### 6.8.3 Allow 헤더
## 6.9 추가 정보
